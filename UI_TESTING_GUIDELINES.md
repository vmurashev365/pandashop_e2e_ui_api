# UI Testing Guidelines - Безопасное тестирование без реальных заказов

## ⚠️ КРИТИЧЕСКИ ВАЖНО: НЕ СОЗДАВАТЬ РЕАЛЬНЫЕ ЗАКАЗЫ

### Принципы безопасного UI тестирования:

#### ✅ ЧТО МОЖНО ТЕСТИРОВАТЬ:
- **Навигация по сайту** - переходы между страницами
- **Отображение интерфейса** - загрузка элементов, макеты, стили
- **Поиск и фильтрация** - функциональность поиска товаров
- **Добавление в корзину** - UI процесс добавления (НЕ финальное оформление)
- **Заполнение форм** - ввод данных в поля (БЕЗ отправки)
- **Валидация форм** - проверка сообщений об ошибках
- **Адаптивность** - тестирование на разных разрешениях
- **Доступность элементов** - проверка видимости и кликабельности

#### ❌ ЧТО НЕЛЬЗЯ ДЕЛАТЬ:
- **Финальное оформление заказов** - НЕ нажимать "Оформить заказ"
- **Реальные платежи** - НЕ вводить настоящие платежные данные
- **Отправка заявок** - НЕ отправлять контактные формы
- **Регистрация аккаунтов** - НЕ создавать реальные учетные записи
- **Изменение данных** - НЕ модифицировать товары/цены

### Стратегии безопасного тестирования:

#### 1. **Тестирование до последнего шага**
```typescript
// ✅ ПРАВИЛЬНО - тестируем процесс БЕЗ финального клика
await fillCheckoutForm(page);
const checkoutButton = page.locator('button:has-text("Оформить заказ")');
await expect(checkoutButton).toBeVisible();
await expect(checkoutButton).toBeEnabled();
// НЕ КЛИКАЕМ checkoutButton! Только проверяем доступность
```

#### 2. **Тестирование форм без отправки**
```typescript
// ✅ ПРАВИЛЬНО - заполняем но не отправляем
await page.fill('[name="email"]', 'test@example.com');
await page.fill('[name="phone"]', '+373 69 123 456');
await page.fill('[name="address"]', 'Тестовый адрес');

// Проверяем валидацию
await expect(page.locator('.form-valid')).toBeVisible();
// НЕ ОТПРАВЛЯЕМ ФОРМУ!
```

#### 3. **Тестирование корзины осторожно**
```typescript
// ✅ ПРАВИЛЬНО - добавляем в корзину для тестирования UI
await addToCart(page);
await verifyCartUI(page);
// В конце ОЧИЩАЕМ корзину или используем инкогнито
await clearCart(page);
```

#### 4. **Использование тестовых данных**
```typescript
const TEST_DATA = {
  email: 'ui-test@example.com',
  phone: '+373 69 999 999',
  address: 'UI Test Address',
  name: 'UI Test User'
};
// Явно тестовые данные, не реальные
```

#### 5. **Проверка состояний без действий**
```typescript
// ✅ ПРАВИЛЬНО - проверяем что элементы готовы к использованию
await expect(page.locator('.payment-methods')).toBeVisible();
await expect(page.locator('.delivery-options')).toBeVisible();
await expect(page.locator('.order-summary')).toBeVisible();
// НЕ ВЗАИМОДЕЙСТВУЕМ с финальными элементами
```

### Безопасные паттерны для E2E тестов:

#### 1. **Journey testing до checkout**
- Каталог → Товар → Корзина → Форма заказа → СТОП
- Не переходим к финальному подтверждению

#### 2. **Validation testing**
- Тестируем валидацию полей
- Тестируем сообщения об ошибках  
- Тестируем required поля

#### 3. **Integration boundaries**
- API тесты для бизнес-логики заказов
- UI тесты для пользовательского интерфейса
- НЕ смешиваем реальные транзакции в UI тестах

### Cleanup стратегии:

```typescript
test.afterEach(async ({ page }) => {
  // Очистка после каждого теста
  await clearLocalStorage(page);
  await clearSessionStorage(page);
  await clearCart(page);
});
```

### Индикаторы тестового окружения:

```typescript
// Проверяем что мы НЕ в продакшене
const isProduction = page.url().includes('pandashop.md');
if (isProduction) {
  console.log('⚠️ PRODUCTION DETECTED - LIMITING TEST SCOPE');
  // Еще более осторожный подход
}
```

## Итоговые правила:

1. **Тестируем UI/UX, НЕ бизнес-транзакции**
2. **Заполняем формы, НЕ отправляем их**  
3. **Проверяем элементы, НЕ кликаем финальные кнопки**
4. **Используем тестовые данные, НЕ реальные**
5. **Очищаем состояние после тестов**

Это обеспечивает безопасное тестирование пользовательского интерфейса без создания реальных заказов или нагрузки на продакшн систему.
